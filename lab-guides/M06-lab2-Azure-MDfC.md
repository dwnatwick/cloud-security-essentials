# Microsoft Defender for Cloud

Microsoft Defender for Cloud is a cloud-native application protection platform (CNAPP) that helps strengthen your security posture, enables protection against modern threats, and helps reduce risk throughout the cloud application lifecycle across multicloud and hybrid environments. Microsoft Defender for Cloud helps you raise your organization's security posture by enabling you to:

-   Incorporate good security practices early during the software development process, or DevSecOps. You can use features such as infrastructure-as-code security, code security guidance, and DevOps posture visibility to help keep cloud applications secure from the start.
-   Gain visibility into data assets across your organization, including on-premises, multi-cloud, and software-as-a-service (SaaS) sources. You can use features such as security posture monitoring, regulatory compliance, and attack-path analysis to proactively improve your cloud security posture.
-   Help prevent, detect, and respond quickly to threats. You can use features such as workload protection, vulnerability scanning, and integrated threat protection with SIEM and XDR to gain comprehensive multicloud protection across cloud apps, infrastructure, and data.

Microsoft Defender for Cloud is based on open standards and interoperable with other Decentralized Identity solutions. It is also integrated with other Microsoft security solutions, such as Microsoft 365 Defender, Defender 365, and Microsoft Sentinel. By using Microsoft Defender for Cloud, you can elevate your security posture and protect your data against risks.

In this lab, you are a Security Operations Analyst working at a company that implemented Microsoft Defender for Cloud. You need to respond to recommendations and security alerts generated by Microsoft Defender for Cloud. You're a Security Operations Analyst working at a company that is implementing cloud workload protection with Microsoft Defender for Cloud. In this lab, you'll enable Microsoft Defender for Cloud.

## Task 1: Access the Azure portal and set up a Subscription

In this task, you'll set up an Azure Subscription required to complete this lab and future labs in this section.

1.  Open the Microsoft Edge browser or open a new tab if already open.
2.  In the Edge browser, navigate to the Azure portal at (+++https://portal.azure.com+++).
3.  In the **Sign in** dialog box, copy, and paste in the tenant Email account for the admin username provided by your lab hosting provider and then select **Next**.
4.  In the **Enter password** dialog box, copy, and paste in the admin's tenant password provided by your lab hosting provider and then select **Sign in**.
5.  In the Search bar of the Azure portal, type *Subscription*, then select **Subscriptions**.
6.  Select the *"Azure Pass - Sponsorship"* subscription shown (or equivalent name in your selected language).
7.  **Note:** If the subscription is not shown, ask your instructor on how to create the Azure subscription with your tenant admin user credentials. **Note:** The subscription creation process could take up to 10 minutes.
8.  Select **Access control (IAM)** and then select **Add role assignment** from the *Grant access to this resource* box.
9.  Select the **Privileged administrator roles** tab and then select **Owner**. Select **Next** to continue.
10. Under the *Members* tab, select **+ Select members** and select the **M365 Administrator** account and select **Select** to continue.
11. Select **Review + assign** twice to assign the owner role to your admin account.

**Important:** These labs have been designed to use less than USD \$10 of Azure services during the class.

## Task 2: Create a Log Analytics Workspace

In this task, you'll create a Log Analytics workspace for use with Microsoft Defender for Cloud.

1.  In the Search bar of the Azure portal, type *Log Analytics workspaces*, then select the same service name.
2.  Select **+Create** from the command bar.
3.  Select **Create new** for the Resource group.
4.  Enter *RG-Defender* and select **Ok**.
5.  For the Name, enter something unique like: *uniquenameDefender*.
6.  Select **Review + Create**.
7.  Once the workspace validation has passed, select **Create**. Wait for the new workspace to be provisioned, this may take a few minutes.

## Task 3: Enable Microsoft Defender for Cloud

In this task, you'll enable and configure Microsoft Defender for Cloud.

1.  In the Search bar of the Azure portal, type *Defender*, then select **Microsoft Defender for Cloud**.
2.  On the **Getting started** page, under the **Upgrade** tab, make sure your subscription is selected, and then select the **Upgrade** button at the bottom of the page. Wait for the *Trial started* notification to appear, it takes about 2 minutes.
3.  **Hint:** You can click the bell button on the top bar to review your Azure portal notifications.
4.  **Note:** If you see the error *"Could not start Azure Defender trial on the subscription"*, continue with the next steps to enable all the Defender plans in Step 5.
5.  In the left menu for Microsoft Defender for Cloud, under the Management, select **Environment settings**.
6.  Select the **"Azure Pass - Sponsorship"** subscription (or equivalent name in your Language).
7.  Review the Azure resources that are now protected with the Defender for Cloud plans.
8.  **Important:** If all Defender plans are *Off*, select **Enable all plans** and then click **Save**. Wait for the *"Resource plan in subscription Azure Pass were saved successfully!"* notification to appear.
9.  Select the **Settings & monitoring** tab from the Settings area (next to Save).
10. Review the monitoring extensions. It includes configurations for Virtual Machines, Containers and Storage Accounts. Close the "Settings & monitoring" page by selecting the 'X' on the upper right of the page.
11. Close the settings page by selecting the 'X' on the upper right of the page to go back to the **Environment settings** and select the '\>' to the left of your subscription.
12. Select the Log analytics workspace you created earlier *uniquenameDefender* to review the available options and pricing.
13. Select **Enable all plans** (to the right of Select Defender plan) and then select **Save**. Wait for the *"Microsoft Defender plan for workspace uniquenameDefender were saved successfully!"* notification to appear.
14. **Note:** If the page is not being displayed, refresh your Edge browser and try again.
15. Close the Defender plans page by selecting the 'X' on the upper right of the page to go back to the **Environment settings**

## Task 4: Explore Regulatory Compliance

Regulatory compliance is important in Microsoft Defender for Cloud because it helps you meet the security and compliance requirements for your hybrid cloud environment. It shows you how well you are following the best practices and standards that you have applied to your subscriptions, such as PCI-DSS, ISO 27001, NIST 800-53, and more. It also gives you recommendations and insights on how to improve your compliance posture and reduce your risk factors. You can also download reports, set up alerts, and export your compliance data using Defender for Cloud.

In this task, you will review Regulatory compliance configuration in Microsoft Defender for Cloud.

1.  Under *Cloud Security*, select **Regulatory compliance** in the portal menu.
2.  Select **Manage compliance policies** on the toolbar.
3.  Select your subscription.
4.  Under *Policy settings*, select **Security policy** in the portal menu.
5.  Scroll down and review the "Industry & regulatory standards" available to you by default. Note that *ISO 27001* is now deprecated.
6.  Select **Add more standards** to add the updated ISO 27001:2013 regulatory standard.
7.  Select the **Add** button to right of *ISO 27001:2013*.
8.  A new page to assign the Azure Policy initiative opens. Confirm that your subscription is selected under *Scope* and click **Review and create**.
9.  Select **Create** to assign the Azure Policy initiative to your subscription.
10. Select Microsoft Defender for Cloud below the search box to return to the main blade.
11. **Note:** You might want to return later to *Regulatory compliance* to review the new standard controls and recommendations.

## Task 5: Mitigate security alerts

The ability to mitigate security alerts in Microsoft Defender for Cloud is important because it helps you to protect your resources from potential threats and reduce the impact of a breach. By mitigating security alerts, you can:

-   Identify and resolve the root cause of the suspicious activity that triggered the alert.
-   Prevent further damage or data loss by stopping the attacker's actions or blocking their access.
-   Harden your resources and prevent future attacks of the same kind by following the security recommendations.
-   Streamline your response process by using automated actions or logic apps.

In this task, you will load sample security alerts and review the alert details.

1.  Under *General*, select **Security alerts** in the portal menu.
2.  Select **Sample alerts** from the command bar. **Hint:** you may need to select the ellipsis (...) button from the command bar).
3.  In the Create sample alerts (Preview) pane make sure your subscription is selected and that all sample alerts are selected in the *Defender for Cloud plans* area.
4.  Select **Create sample alerts**.
5.  **Note:** This sample alert creation process may take a few minutes to complete, wait for the *"Successfully created sample alerts"* notification.
6.  Once completed, select **Refresh** to see the alerts appear under the *Security alerts* area.
7.  For the alerts that grabbed your attention, perform the following actions:
    1.  Select the alert, information about the alert should appear. Select **View full details**.
    2.  Review and read the *Alert details* tab.
    3.  Select the **Take action** tab or select the **Next: Take Action** button at the end of the page.
    4.  Review the *Take action* information. Notice the sections available to take action depending on the type of alert: Inspect resource context, Mitigate the threat, Prevent future attacks, Trigger automated response and Suppress similar alerts.

You can also use the Take action tab to inspect resource context, mitigate the threat, prevent future attacks, or trigger automated response.

## Task 6: Review the Secure Score

Defender for Cloud displays your score prominently in the portal. When you select the Secure score tile on the overview page, you're taken to the dedicated secure score page, where you'll see the score broken down by subscription. Select a single subscription to see the detailed list of prioritized recommendations and the potential effect that remediating them will have on the subscription's score.

Your secure score is shown in the following locations in Defender for Cloud's portal pages:

1.  Review the Secure Score on the tile on Defender for Cloud's **Overview** (main dashboard)
2.  Review the Secure Score on the dedicated **Secure score page** where you can see the secure score for your subscription and your management groups.
3.  Review the Secure Score at the top of the **Recommendations** page.

## Task 7: Enable data-aware security posture

Data-aware security posture is a feature of Microsoft Defender for Cloud that provides automatic discovery and evaluation of data sensitivity and exposure. It helps you to reduce risk to data and respond to data breaches.

Some of the benefits of using data-aware security posture are:

-   You can automatically discover sensitive data resources across multiple clouds, such as object stores and databases.
-   You can evaluate data sensitivity, data exposure, and how data flows across the organization.
-   You can proactively and continuously uncover risks that might lead to data breaches.
-   You can detect suspicious activities that might indicate ongoing threats to sensitive data resources.
1.  Navigate to **Microsoft Defender for Cloud \> Environmental settings**.
2.  Select the relevant Azure subscription.
3.  For the Defender CSPM plan, select the **On** status.
4.  If Defender CSPM is already on, select **Settings** in the Monitoring coverage column of the Defender CSPM plan and make sure that the Sensitive data discovery component is set to **On** status.
5.  Once sensitive data discovery is turned On in Defender CSPM, it will automatically incorporate support for additional resource types as the range of supported resource types expands.

**NOTE:** It takes up to 24 hours to see the results of a first discovery after enabling the feature.

Sensitive data threat detection is enabled by default when the sensitive data discovery component is enabled in the Defender for Storage plan.

## Task 8: Protect your APIs with Defender for APIs

Defender for APIs in Microsoft Defender for Cloud offers full lifecycle protection, detection, and response coverage for APIs. Defender for APIs helps you to gain visibility into business-critical APIs. You can investigate and improve your API security posture, prioritize vulnerability fixes, and quickly detect active real-time threats.

**To enable the Defender for APIs plan:**

1.  In Defender for Cloud, select **Environment settings**.
2.  Select the subscription that contains the managed APIs that you want to protect.
3.  In the APIs plan, select **On**. Then select **Save**.
4.  Select **Save**.

**Onboard APIs:**

1.  In the Defender for Cloud portal, select **Recommendations**.
2.  Search for *Defender for APIs*.
3.  Under **Enable enhanced security features**, select the security recommendation *Azure API Management APIs* *should be onboarded to Defender for APIs*.
4.  In the recommendation page, you can review the recommendation severity, update interval, description, and remediation steps.
5.  Review the resources in scope for the recommendations:
    1.  **Unhealthy resources:** Resources that aren't onboarded to Defender for APIs.
    2.  **Healthy resources:** API resources that are onboarded to Defender for APIs.
    3.  **Not applicable resources:** API resources that aren't applicable for protection.
6.  In *Unhealthy resources*, select the APIs that you want to protect with Defender for APIs.
7.  Select **Fix**.
8.  In Fixing resources, review the selected APIs, and select **Fix resources**.
9.  Verify that remediation was successful.
